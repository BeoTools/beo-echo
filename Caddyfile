{
    # Global Caddy settings
    admin off
    auto_https off
}

:80 {
    # Log requests
    log {
        output file /var/log/caddy/access.log
        format console
    }

    # Define routes for frontend - root, /home, and /login paths
    @frontend {
        path / /home /login
    }

    # Handle frontend routes - serve the SvelteKit static files
    handle @frontend {
        root * /app/frontend
        try_files {path} /index.html
        file_server
    }

    # All other routes go to the backend
    handle {
        # Reverse proxy to backend
        reverse_proxy localhost:4000
    }

    # Handle errors
    handle_errors {
        respond "{err.status_code} {err.status_text}"
    }
}
